<EditTaskScreen>:

    MDBoxLayout:
        orientation: "vertical"
        # padding:"10dp"
        id: edit_container

        MDTopAppBar:
            # y: root.height - self.height
            type_height: "small"
            use_overflow: True
            elevation: 0
            opposite_colors: True
            title: "Edit task"
            anchor_title: "left"
            left_action_items: [["arrow-left", lambda x : root.back_action()]]

        CheckSwitchItem:
            group: "root"
            text: "mark as done"
            size_hint_x: .9
            pos_hint_x: "center"

        MDTextField:
            id: task_text
            text: ""
            text_color_normal: 0, 0, 0, 1
            max_text_length: 50
            max_length_text_color: "red"
            required: True
            # on_text_validate: (root.add_task(task_text, date_text.text))

        ScrollView:
            pos_hint: {"center_y": .5, "center_x": .5}
            size_hint: .9, .8
            bar_width: 5
            do_scroll_x: False

            MDTextField:
                id: task_description
                adaptive_height: True
                hint_text: "Description"
                text: "Not finish this functionality yet..."
                max_text_length: 500
                mode: "rectangle"
                max_length_text_color: "red"
                # helper_text: "500"
                multiline: True
                required: False
                # on_focus: if self.focus: root.show_description_dialog()

        MDGridLayout:
            rows: 4
            cols: 2
            adaptive_height: True
            width: .9

            MDTextField:
                id: date_text
                icon_left: "calendar"
                icon_left_color_normal: 0, 0, 0, 1
                text_color_normal: 0, 0, 0, 1
                halign: "right"
                hint_text: "date"
                on_focus: if self.focus: root.date_picker()

            MDIconButton:
                icon: "minus-thick"
                on_release: date_text.text = ""

            MDTextField:
                id: project
                text: "Not finish this functionality yet..."
                icon_left: "collage"
                icon_left_color_normal: 0, 0, 0, 1
                halign: "right"
                hint_text: "project"
                on_focus: if self.focus: root.project_select()

            MDIconButton:
                icon: "minus-thick"
                on_release: project.text = ""

            MDTextField:
                id: context
                icon_left: "contain"
                text: "Not finish this functionality yet..."
                icon_left_color_normal: 0, 0, 0, 1
                halign: "right"
                hint_text: "context"
                on_focus: if self.focus: root.context_select()

            MDIconButton:
                icon: "minus-thick"
                on_release: context.text = ""

            MDTextField:
                id: attachment
                icon_left: "attachment"
                text: "Not finish this functionality yet..."
                icon_left_color_normal: 0, 0, 0, 1
                halign: "right"
                hint_text: "attachment"
                on_focus: if self.focus: root.file_manager_open()

            MDIconButton:
                icon: "minus-thick"
                on_release: attachment.text = ""

        MDGridLayout:
            orientation: "bt-rl"
            size_hint_x: 1
            adaptive_height: True
            rows: 1
            padding: 0, "20dp", "5dp", 0

            MDFlatButton:
                text: "[b]SAVE[/b]"
                font_size: "18sp"
                spacing: "30dp", 0, "10dp", 0
                on_release: 
                    root.write_task(task_text, date_text.text)
                    app.root.get_screen(name="task list screen").ids.container.clear_widgets()
                    app.on_start()
                    root.back_action()

            MDFlatButton:
                halign: "right"
                text: "CANCEL"
                font_size: "18sp"
                on_release:
                    root.back_action()

            MDLabel:
                # spacer            
            MDLabel:
                id: task_id
                text: ""
                # adaptive_height: True
                halign: "left"
                font_size: "14sp"
                pos_hint: {"center_y": .5}
                theme_text_color: "Custom"
                text_color: "lightgray"

            MDIconButton:
                icon: "trash-can-outline"
                theme_text_color: "Custom"
                text_color: 1, 0, 0, 1
                icon_size: "28sp"
                # TODO: confirmation dialog
                on_release:
                    root.delete_task(task_id.text)
                    app.root.get_screen(name="task list screen").ids.container.clear_widgets()
                    app.on_start()
                    root.back_action()


<CheckSwitchItem>:
    adaptive_height: True
    size_hint_x: .9
    padding: "10dp"
    
    MDCheckbox:
        size_hint: None, None
        size: "36dp", "36dp"
        pos_hint: {"center_y": .5}
        group: root.group
    
    MDLabel:
        text: root.text
        adaptive_height: True
        halign: "left"
        pos_hint: {"center_y": .5}
        theme_text_color: "Custom"
        text_color: "gray"